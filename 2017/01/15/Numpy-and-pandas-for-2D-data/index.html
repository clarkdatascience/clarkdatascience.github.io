<!doctype html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="numpy,pandas," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="Part 1123456789101112131415161718import numpy as npimport seaborn%pylab inline# Subway ridership for 5 stations on 10 different daysridership = np.array([    [   0,    0,    2,    5,    0],    [1478,">
<meta property="og:type" content="article">
<meta property="og:title" content="Numpy and pandas for 2D data">
<meta property="og:url" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/index.html">
<meta property="og:site_name" content="Notes on Data Science">
<meta property="og:description" content="Part 1123456789101112131415161718import numpy as npimport seaborn%pylab inline# Subway ridership for 5 stations on 10 different daysridership = np.array([    [   0,    0,    2,    5,    0],    [1478,">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/1.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/2.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/3.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/4.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/5.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/6.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/output_13_1.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/7.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/8.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/9.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/10.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/output_42_1.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/11.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/12.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/3.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/output_4_1.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/output_7_1.png">
<meta property="og:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/output_9_2.png">
<meta property="og:updated_time" content="2017-01-15T20:41:00.047Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Numpy and pandas for 2D data">
<meta name="twitter:description" content="Part 1123456789101112131415161718import numpy as npimport seaborn%pylab inline# Subway ridership for 5 stations on 10 different daysridership = np.array([    [   0,    0,    2,    5,    0],    [1478,">
<meta name="twitter:image" content="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/"/>





  <title> Numpy and pandas for 2D data | Notes on Data Science </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Notes on Data Science</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle"></p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-folder"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://clarkdatascience.github.io/2017/01/15/Numpy-and-pandas-for-2D-data/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="ClarkYu">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Notes on Data Science">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Notes on Data Science" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Numpy and pandas for 2D data
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-15T20:15:24+00:00">
                2017-01-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Udacity/" itemprop="url" rel="index">
                    <span itemprop="name">Udacity</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/01/15/Numpy-and-pandas-for-2D-data/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/01/15/Numpy-and-pandas-for-2D-data/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Part-1"><a href="#Part-1" class="headerlink" title="Part 1"></a>Part 1</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> seaborn</div><div class="line">%pylab inline</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># Subway ridership for 5 stations on 10 different days</span></div><div class="line">ridership = np.array([</div><div class="line">    [   <span class="number">0</span>,    <span class="number">0</span>,    <span class="number">2</span>,    <span class="number">5</span>,    <span class="number">0</span>],</div><div class="line">    [<span class="number">1478</span>, <span class="number">3877</span>, <span class="number">3674</span>, <span class="number">2328</span>, <span class="number">2539</span>],</div><div class="line">    [<span class="number">1613</span>, <span class="number">4088</span>, <span class="number">3991</span>, <span class="number">6461</span>, <span class="number">2691</span>],</div><div class="line">    [<span class="number">1560</span>, <span class="number">3392</span>, <span class="number">3826</span>, <span class="number">4787</span>, <span class="number">2613</span>],</div><div class="line">    [<span class="number">1608</span>, <span class="number">4802</span>, <span class="number">3932</span>, <span class="number">4477</span>, <span class="number">2705</span>],</div><div class="line">    [<span class="number">1576</span>, <span class="number">3933</span>, <span class="number">3909</span>, <span class="number">4979</span>, <span class="number">2685</span>],</div><div class="line">    [  <span class="number">95</span>,  <span class="number">229</span>,  <span class="number">255</span>,  <span class="number">496</span>,  <span class="number">201</span>],</div><div class="line">    [   <span class="number">2</span>,    <span class="number">0</span>,    <span class="number">1</span>,   <span class="number">27</span>,    <span class="number">0</span>],</div><div class="line">    [<span class="number">1438</span>, <span class="number">3785</span>, <span class="number">3589</span>, <span class="number">4174</span>, <span class="number">2215</span>],</div><div class="line">    [<span class="number">1342</span>, <span class="number">4043</span>, <span class="number">4009</span>, <span class="number">4665</span>, <span class="number">3033</span>]</div><div class="line">])</div></pre></td></tr></table></figure>
<pre><code>Populating the interactive namespace from numpy and matplotlib
</code></pre><a id="more"></a>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Accessing elements</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    <span class="keyword">print</span> ridership[<span class="number">1</span>, <span class="number">3</span>]</div><div class="line">    <span class="keyword">print</span> ridership[<span class="number">1</span>:<span class="number">3</span>, <span class="number">3</span>:<span class="number">5</span>]</div><div class="line">    <span class="keyword">print</span> ridership[<span class="number">1</span>, :]</div></pre></td></tr></table></figure>
<pre><code>2328
[[2328 2539]
 [6461 2691]]
[1478 3877 3674 2328 2539]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Vectorized operations on rows or columns</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    <span class="keyword">print</span> ridership[<span class="number">0</span>, :] + ridership[<span class="number">1</span>, :]</div><div class="line">    <span class="keyword">print</span> ridership[:, <span class="number">0</span>] + ridership[:, <span class="number">1</span>] <span class="comment">#&#x6700;&#x540E;&#x53D8;&#x6210;&#x4E00;&#x7EC4;&#x6A2A;&#x7684;&#x6570;&#x5217;</span></div></pre></td></tr></table></figure>
<pre><code>[1478 3877 3676 2333 2539]
[   0 5355 5701 4952 6410 5509  324    2 5223 5385]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Vectorized operations on entire arrays</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    a = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</div><div class="line">    b = np.array([[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>]])</div><div class="line">    <span class="keyword">print</span> a + b</div></pre></td></tr></table></figure>
<pre><code>Populating the interactive namespace from numpy and matplotlib
[[ 2  3  4]
 [ 6  7  8]
 [10 11 12]]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">mean_riders_for_max_station</span><span class="params">(ridership)</span>:</span></div><div class="line">    <span class="string">&apos;&apos;&apos;</span></div><div class="line">    Fill in this function to find the station with the maximum riders on the</div><div class="line">    first day, then return the mean riders per day for that station. Also</div><div class="line">    return the mean ridership overall for comparsion.</div><div class="line"></div><div class="line">    Hint: NumPy&apos;s argmax() function might be useful:</div><div class="line">    http://docs.scipy.org/doc/numpy/reference/generated/numpy.argmax.html</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    max_pos = ridership[<span class="number">0</span>,:].argmax()</div><div class="line">    overall_mean =  ridership.mean()</div><div class="line">    mean_for_max = ridership[:, max_pos].mean()</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (overall_mean, mean_for_max)</div><div class="line"></div><div class="line"><span class="keyword">print</span> mean_riders_for_max_station(ridership)</div></pre></td></tr></table></figure>
<pre><code>(2342.5999999999999, 3239.9000000000001)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># NumPy axis argument</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    a = np.array([</div><div class="line">        [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">        [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</div><div class="line">        [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</div><div class="line">    ])</div><div class="line"></div><div class="line">    <span class="keyword">print</span> a.sum()</div><div class="line">    <span class="keyword">print</span> a.sum(axis=<span class="number">0</span>) <span class="comment">#&#x7EB5;&#x8F74;&#x76F8;&#x52A0;</span></div><div class="line">    <span class="keyword">print</span> a.sum(axis=<span class="number">1</span>) <span class="comment">#&#x6A2A;&#x8F74;&#x76F8;&#x52A0;</span></div></pre></td></tr></table></figure>
<pre><code>45
[12 15 18]
[ 6 15 24]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">min_and_max_riders_per_day</span><span class="params">(ridership)</span>:</span></div><div class="line">    <span class="string">&apos;&apos;&apos;</span></div><div class="line">    Fill in this function. First, for each subway station, calculate the</div><div class="line">    mean ridership per day. Then, out of all the subway stations, return the</div><div class="line">    maximum and minimum of these values. That is, find the maximum</div><div class="line">    mean-ridership-per-day and the minimum mean-ridership-per-day for any</div><div class="line">    subway station.</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    mean_ridership_per_station = ridership.mean(axis=<span class="number">0</span>)</div><div class="line">    max_daily_ridership = mean_ridership_per_station.max()</div><div class="line">    min_daily_ridership = mean_ridership_per_station.min()  </div><div class="line"></div><div class="line">    <span class="keyword">return</span> (max_daily_ridership, min_daily_ridership)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">min_and_max_riders_per_day(ridership)</div></pre></td></tr></table></figure>
<pre><code>(3239.9000000000001, 1071.2)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="comment"># Subway ridership for 5 stations on 10 different days</span></div><div class="line">ridership_df = pd.DataFrame(</div><div class="line">    data=[[   <span class="number">0</span>,    <span class="number">0</span>,    <span class="number">2</span>,    <span class="number">5</span>,    <span class="number">0</span>],</div><div class="line">          [<span class="number">1478</span>, <span class="number">3877</span>, <span class="number">3674</span>, <span class="number">2328</span>, <span class="number">2539</span>],</div><div class="line">          [<span class="number">1613</span>, <span class="number">4088</span>, <span class="number">3991</span>, <span class="number">6461</span>, <span class="number">2691</span>],</div><div class="line">          [<span class="number">1560</span>, <span class="number">3392</span>, <span class="number">3826</span>, <span class="number">4787</span>, <span class="number">2613</span>],</div><div class="line">          [<span class="number">1608</span>, <span class="number">4802</span>, <span class="number">3932</span>, <span class="number">4477</span>, <span class="number">2705</span>],</div><div class="line">          [<span class="number">1576</span>, <span class="number">3933</span>, <span class="number">3909</span>, <span class="number">4979</span>, <span class="number">2685</span>],</div><div class="line">          [  <span class="number">95</span>,  <span class="number">229</span>,  <span class="number">255</span>,  <span class="number">496</span>,  <span class="number">201</span>],</div><div class="line">          [   <span class="number">2</span>,    <span class="number">0</span>,    <span class="number">1</span>,   <span class="number">27</span>,    <span class="number">0</span>],</div><div class="line">          [<span class="number">1438</span>, <span class="number">3785</span>, <span class="number">3589</span>, <span class="number">4174</span>, <span class="number">2215</span>],</div><div class="line">          [<span class="number">1342</span>, <span class="number">4043</span>, <span class="number">4009</span>, <span class="number">4665</span>, <span class="number">3033</span>]],</div><div class="line">    index=[<span class="string">&apos;05-01-11&apos;</span>, <span class="string">&apos;05-02-11&apos;</span>, <span class="string">&apos;05-03-11&apos;</span>, <span class="string">&apos;05-04-11&apos;</span>, <span class="string">&apos;05-05-11&apos;</span>,</div><div class="line">           <span class="string">&apos;05-06-11&apos;</span>, <span class="string">&apos;05-07-11&apos;</span>, <span class="string">&apos;05-08-11&apos;</span>, <span class="string">&apos;05-09-11&apos;</span>, <span class="string">&apos;05-10-11&apos;</span>],</div><div class="line">    columns=[<span class="string">&apos;R003&apos;</span>, <span class="string">&apos;R004&apos;</span>, <span class="string">&apos;R005&apos;</span>, <span class="string">&apos;R006&apos;</span>, <span class="string">&apos;R007&apos;</span>]</div><div class="line">)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ridership_df.mean()</div></pre></td></tr></table></figure>
<pre><code>R003    1071.2
R004    2814.9
R005    2718.8
R006    3239.9
R007    1868.2
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ridership_df.values.mean()  <span class="comment">#!!!&#x6CE8;&#x610F;&#x4E86;&#xFF01;&#x8FD9;&#x91CC;&#x7684;values&#x540E;&#x9762;&#x662F;&#x6CA1;&#x6709;&#xFF08;&#xFF09;&#x7684;&#xFF01;&#xFF01;&#xFF01;&#x6240;&#x6709;&#x7684;&#x52A0;&#x8D77;&#x6765; &#x5176;&#x5B9E;&#x5C31;&#x662F;ridership_df.mean().mean()</span></div></pre></td></tr></table></figure>
<pre><code>2342.5999999999999
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Change False to True for each block of code to see what it does</span></div><div class="line"></div><div class="line"><span class="comment"># DataFrame creation</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    <span class="comment"># You can create a DataFrame out of a dictionary mapping column names to values</span></div><div class="line">    df_1 = pd.DataFrame({<span class="string">&apos;A&apos;</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], <span class="string">&apos;B&apos;</span>: [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]})</div><div class="line">    <span class="keyword">print</span> df_1</div><div class="line"></div><div class="line">    <span class="comment"># You can also use a list of lists or a 2D NumPy array</span></div><div class="line">    df_2 = pd.DataFrame([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]], columns=[<span class="string">&apos;A&apos;</span>, <span class="string">&apos;B&apos;</span>, <span class="string">&apos;C&apos;</span>])</div><div class="line">    <span class="keyword">print</span> df_2</div></pre></td></tr></table></figure>
<pre><code>   A  B
0  0  3
1  1  4
2  2  5
   A  B  C
0  0  1  2
1  3  4  5
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ridership_df</div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Accessing elements</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    <span class="keyword">print</span> ridership_df.iloc[<span class="number">0</span>] <span class="comment">#iol&#x6307;&#x5B9A;&#x76F8;&#x5E94;&#x7684;row</span></div><div class="line">    <span class="keyword">print</span> ridership_df.loc[<span class="string">&apos;05-05-11&apos;</span>] <span class="comment">#&#x6307;&#x5B9A;&#x76F8;&#x5E94;&#x7684;row&#xFF0C;&#x7D22;&#x5F15;&#x7684;&#x662F;&#x5B57;&#x7B26;&#x884C;</span></div><div class="line">    <span class="keyword">print</span> ridership_df[<span class="string">&apos;R003&apos;</span>]</div><div class="line">    <span class="keyword">print</span> ridership_df.iloc[<span class="number">1</span>, <span class="number">3</span>] <span class="comment">#row, column</span></div></pre></td></tr></table></figure>
<pre><code>R003    0
R004    0
R005    2
R006    5
R007    0
Name: 05-01-11, dtype: int64
R003    1608
R004    4802
R005    3932
R006    4477
R007    2705
Name: 05-05-11, dtype: int64
05-01-11       0
05-02-11    1478
05-03-11    1613
05-04-11    1560
05-05-11    1608
05-06-11    1576
05-07-11      95
05-08-11       2
05-09-11    1438
05-10-11    1342
Name: R003, dtype: int64
2328
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Accessing multiple rows</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    <span class="keyword">print</span> ridership_df.iloc[<span class="number">1</span>:<span class="number">4</span>]</div><div class="line"></div><div class="line"><span class="comment"># Accessing multiple columns</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    <span class="keyword">print</span> ridership_df[[<span class="string">&apos;R003&apos;</span>, <span class="string">&apos;R005&apos;</span>]]</div></pre></td></tr></table></figure>
<pre><code>          R003  R004  R005  R006  R007
05-02-11  1478  3877  3674  2328  2539
05-03-11  1613  4088  3991  6461  2691
05-04-11  1560  3392  3826  4787  2613
          R003  R005
05-01-11     0     2
05-02-11  1478  3674
05-03-11  1613  3991
05-04-11  1560  3826
05-05-11  1608  3932
05-06-11  1576  3909
05-07-11    95   255
05-08-11     2     1
05-09-11  1438  3589
05-10-11  1342  4009
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Pandas axis</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    df = pd.DataFrame({<span class="string">&apos;A&apos;</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], <span class="string">&apos;B&apos;</span>: [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]})</div><div class="line"></div><div class="line">df</div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Pandas axis</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    df = pd.DataFrame({<span class="string">&apos;A&apos;</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], <span class="string">&apos;B&apos;</span>: [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]})</div><div class="line">    <span class="keyword">print</span> df.sum() <span class="comment">#&#x9ED8;&#x8BA4;&#x662F;axis=0&#xFF0C;&#x6309;&#x7167;column&#x6765;&#x7EDF;&#x8BA1;&#xFF0C;&#x7EB5;&#x5411;&#x6C42;&#x548C;</span></div><div class="line">    <span class="keyword">print</span> df.sum(axis=<span class="number">1</span>) <span class="comment">#&#x6A2A;&#x7EBF;&#x6C42;&#x548C;</span></div><div class="line">    <span class="keyword">print</span> df.values.sum()<span class="comment">#&#x6240;&#x6709;cell&#x4E00;&#x8D77;&#x6C42;&#x548C;</span></div></pre></td></tr></table></figure>
<pre><code>A     3
B    12
dtype: int64
0    3
1    5
2    7
dtype: int64
15
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">mean_riders_for_max_station</span><span class="params">(ridership)</span>:</span></div><div class="line">    <span class="string">&apos;&apos;&apos;</span></div><div class="line">    Fill in this function to find the station with the maximum riders on the</div><div class="line">    first day, then return the mean riders per day for that station. Also</div><div class="line">    return the mean ridership overall for comparsion.</div><div class="line"></div><div class="line">    This is the same as a previous exercise, but this time the</div><div class="line">    input is a Pandas DataFrame rather than a 2D NumPy array.</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    overall_mean = ridership.values.mean()</div><div class="line">    mean_for_max = ridership[ridership.iloc[<span class="number">0</span>].argmax()].mean()</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (overall_mean, mean_for_max)</div><div class="line"></div><div class="line"><span class="keyword">print</span> (mean_riders_for_max_station(ridership_df)</div></pre></td></tr></table></figure>
<h1 id="Part-2"><a href="#Part-2" class="headerlink" title="Part 2"></a>Part 2</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</div><div class="line">%pylab inline</div><div class="line"></div><div class="line"></div><div class="line">subway_df = pd.read_csv(<span class="string">&apos;nyc_subway_weather.csv&apos;</span>)</div></pre></td></tr></table></figure>
<pre><code>Populating the interactive namespace from numpy and matplotlib
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subway_df.head()</div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/3.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subway_df.describe()</div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/4.png" alt="png"></p>
<p>DATEn&#x548C;TIMEn&#x8FD9;&#x4E24;&#x4E2A;&#x53C2;&#x6570;&#x662F;&#x6307;&#x4FE1;&#x606F;&#x5728;&#x65CB;&#x8F6C;&#x95E8;&#x5904;&#x91C7;&#x96C6;&#x6570;&#x636E;&#x7684;&#x65E5;&#x671F;&#x4E0E;&#x65F6;&#x95F4;&#x3002;<br>ENTRIESn&#x548C;EXITSn&#x662F;&#x5728;&#x8FD9;&#x4E2A;&#x65F6;&#x95F4;&#xFF0C;&#x5165;&#x53E3;&#x4E0E;&#x51FA;&#x53E3;&#x7D2F;&#x8BA1;&#x7684;&#x603B;&#x4EBA;&#x6570;&#x3002;&#xFF08;&#x5982;&#x679C;&#x4E0A;&#x4E2A;&#x5C0F;&#x65F6;&#x5165;&#x53E3;&#x5904;&#x8BA1;&#x6570;&#x662F;10000&#xFF0C;&#x8FD9;&#x4E00;&#x4E2A;&#x5C0F;&#x65F6;&#x6CA1;&#x6709;&#x4EBA;&#x8FDB;&#x5165;&#xFF0C;&#x8FD9;&#x4E2A;&#x5C0F;&#x65F6;&#x7684;&#x5165;&#x53E3;&#x8BA1;&#x6570;&#x4ECD;&#x7136;&#x662F;10000&#x3002;&#x51FA;&#x53E3;&#x540C;&#x7406;&#xFF09;<br>ENTIRESn_hourly&#x548C;EXITSn_hourly&#x662F;&#x6307;&#x5728;&#x8FD9;&#x4E00;&#x4E2A;&#x5C0F;&#x65F6;&#x5185;&#xFF0C;&#x5165;&#x53E3;&#x548C;&#x51FA;&#x53E3;&#x8BA1;&#x6570;&#x589E;&#x52A0;&#x7684;&#x51C0;&#x4EBA;&#x6570;&#x3002;&#xFF08;&#x5982;&#x679C;&#x8FD9;&#x4E00;&#x5C0F;&#x65F6;&#x6CA1;&#x6709;&#x4EBA;&#x8FDB;&#x5165;&#xFF0C;ENTRIESn_hourly&#x7684;&#x8BA1;&#x6570;&#x5E94;&#x8BE5;&#x662F;0&#xFF09;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">correlation1</span><span class="params">(x, y)</span>:</span></div><div class="line">    <span class="string">&apos;&apos;&apos;</span></div><div class="line">    Fill in this function to compute the correlation between the two</div><div class="line">    input variables. Each input is either a NumPy array or a Pandas</div><div class="line">    Series.</div><div class="line"></div><div class="line">    correlation = average of (x in standard units) times (y in standard units)</div><div class="line"></div><div class="line">    Remember to pass the argument &quot;ddof=0&quot; to the Pandas std() function!</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    cov = (x - x.mean()) * (y - y.mean()) / len(x)</div><div class="line">    correlation = cov.sum() / ( x.std(ddof=<span class="number">0</span>) * y.std(ddof=<span class="number">0</span>))</div><div class="line">    <span class="keyword">return</span> correlation</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">correlation</span><span class="params">(x, y)</span>:</span> <span class="comment">#&#x8BFE;&#x5802;&#x4E0A;&#x6559;&#x7684;&#x6807;&#x51C6;&#x5199;&#x6CD5;&#xFF0C;&#x5176;&#x5B9E;&#x548C;&#x4E0A;&#x9762;&#x662F;&#x4E00;&#x6837;&#x7684;</span></div><div class="line">    std_x = (x - x.mean())/ x.std(ddof=<span class="number">0</span>)</div><div class="line">    std_y = (y - y.mean())/ y.std(ddof=<span class="number">0</span>)</div><div class="line">    correlation = (std_x * std_y).mean()</div><div class="line">    <span class="keyword">return</span> correlation</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">entries = subway_df[<span class="string">&apos;ENTRIESn_hourly&apos;</span>]</div><div class="line">cum_entries = subway_df[<span class="string">&apos;ENTRIESn&apos;</span>]</div><div class="line">rain = subway_df[<span class="string">&apos;meanprecipi&apos;</span>]</div><div class="line">temp = subway_df[<span class="string">&apos;meantempi&apos;</span>]</div><div class="line"></div><div class="line"><span class="keyword">print</span> correlation(entries, rain)</div><div class="line"><span class="keyword">print</span> correlation(entries, temp)</div><div class="line"><span class="keyword">print</span> correlation(rain, temp)</div><div class="line"><span class="keyword">print</span> correlation(entries, cum_entries)</div></pre></td></tr></table></figure>
<pre><code>0.0356485157722
-0.0266933483216
-0.229034323408
0.585895470766
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"></div><div class="line"><span class="comment"># Examples of vectorized operations on DataFrames:</span></div><div class="line"><span class="comment"># Change False to True for each block of code to see what it does</span></div><div class="line"></div><div class="line"><span class="comment"># Adding DataFrames with the column names</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    df1 = pd.DataFrame({<span class="string">&apos;a&apos;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">&apos;b&apos;</span>: [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], <span class="string">&apos;c&apos;</span>: [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]})</div><div class="line">    df2 = pd.DataFrame({<span class="string">&apos;a&apos;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>], <span class="string">&apos;b&apos;</span>: [<span class="number">40</span>, <span class="number">50</span>, <span class="number">60</span>], <span class="string">&apos;c&apos;</span>: [<span class="number">70</span>, <span class="number">80</span>, <span class="number">90</span>]})</div><div class="line">    <span class="keyword">print</span> df1 + df2</div><div class="line"></div><div class="line"><span class="comment"># Adding DataFrames with overlapping column names</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    df1 = pd.DataFrame({<span class="string">&apos;a&apos;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">&apos;b&apos;</span>: [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], <span class="string">&apos;c&apos;</span>: [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]})</div><div class="line">    df2 = pd.DataFrame({<span class="string">&apos;d&apos;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>], <span class="string">&apos;c&apos;</span>: [<span class="number">40</span>, <span class="number">50</span>, <span class="number">60</span>], <span class="string">&apos;b&apos;</span>: [<span class="number">70</span>, <span class="number">80</span>, <span class="number">90</span>]})</div><div class="line">    <span class="keyword">print</span> df1 + df2</div><div class="line"></div><div class="line"><span class="comment"># Adding DataFrames with overlapping row indexes</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">False</span>:</div><div class="line">    df1 = pd.DataFrame({<span class="string">&apos;a&apos;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">&apos;b&apos;</span>: [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], <span class="string">&apos;c&apos;</span>: [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]},</div><div class="line">                       index=[<span class="string">&apos;row1&apos;</span>, <span class="string">&apos;row2&apos;</span>, <span class="string">&apos;row3&apos;</span>])</div><div class="line">    df2 = pd.DataFrame({<span class="string">&apos;a&apos;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>], <span class="string">&apos;b&apos;</span>: [<span class="number">40</span>, <span class="number">50</span>, <span class="number">60</span>], <span class="string">&apos;c&apos;</span>: [<span class="number">70</span>, <span class="number">80</span>, <span class="number">90</span>]},</div><div class="line">                       index=[<span class="string">&apos;row4&apos;</span>, <span class="string">&apos;row3&apos;</span>, <span class="string">&apos;row2&apos;</span>])</div><div class="line">    <span class="keyword">print</span> df1 + df2</div><div class="line"></div><div class="line"><span class="comment"># --- Quiz ---</span></div><div class="line"><span class="comment"># Cumulative entries and exits for one station for a few hours.</span></div><div class="line">entries_and_exits = pd.DataFrame({</div><div class="line">    <span class="string">&apos;ENTRIESn&apos;</span>: [<span class="number">3144312</span>, <span class="number">3144335</span>, <span class="number">3144353</span>, <span class="number">3144424</span>, <span class="number">3144594</span>,</div><div class="line">                 <span class="number">3144808</span>, <span class="number">3144895</span>, <span class="number">3144905</span>, <span class="number">3144941</span>, <span class="number">3145094</span>],</div><div class="line">    <span class="string">&apos;EXITSn&apos;</span>: [<span class="number">1088151</span>, <span class="number">1088159</span>, <span class="number">1088177</span>, <span class="number">1088231</span>, <span class="number">1088275</span>,</div><div class="line">               <span class="number">1088317</span>, <span class="number">1088328</span>, <span class="number">1088331</span>, <span class="number">1088420</span>, <span class="number">1088753</span>]</div><div class="line">})</div></pre></td></tr></table></figure>
<pre><code>    a   b   c
0  11  44  77
1  22  55  88
2  33  66  99
    a   b   c   d
0 NaN  74  47 NaN
1 NaN  85  58 NaN
2 NaN  96  69 NaN
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_hourly_entries_and_exits</span><span class="params">(entries_and_exits)</span>:</span></div><div class="line">    <span class="string">&apos;&apos;&apos;</span></div><div class="line">    Fill in this function to take a DataFrame with cumulative entries</div><div class="line">    and exits (entries in the first column, exits in the second) and</div><div class="line">    return a DataFrame with hourly entries and exits (entries in the</div><div class="line">    first column, exits in the second).</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    <span class="keyword">return</span> entries_and_exits-entries_and_exits.shift(periods=<span class="number">1</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">get_hourly_entries_and_exits(entries_and_exits) <span class="comment">#ENTRIESn&#x548C;EXITSn&#x662F;&#x5728;&#x8FD9;&#x4E2A;&#x65F6;&#x95F4;&#xFF0C;&#x5165;&#x53E3;&#x4E0E;&#x51FA;&#x53E3;&#x7D2F;&#x8BA1;&#x7684;&#x603B;&#x4EBA;&#x6570;,&#x6240;&#x4EE5;&#x76F8;&#x51CF;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x5C0F;&#x65F6;&#x5185;&#x6574;&#x4F53;&#x5BA2;&#x6D41;&#x603B;&#x4EBA;&#x6570;</span></div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/5.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># DataFrame applymap() #&#x904D;&#x5386;&#x6BCF;&#x4E2A;cell</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    df = pd.DataFrame({</div><div class="line">        <span class="string">&apos;a&apos;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</div><div class="line">        <span class="string">&apos;b&apos;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>],</div><div class="line">        <span class="string">&apos;c&apos;</span>: [<span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>]</div><div class="line">    })</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_one</span><span class="params">(x)</span>:</span></div><div class="line">        <span class="keyword">return</span> x + <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="keyword">print</span> df.applymap(add_one)</div></pre></td></tr></table></figure>
<pre><code>   a   b   c
0  2  11   6
1  3  21  11
2  4  31  16
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">grades_df = pd.DataFrame(</div><div class="line">    data={<span class="string">&apos;exam1&apos;</span>: [<span class="number">43</span>, <span class="number">81</span>, <span class="number">78</span>, <span class="number">75</span>, <span class="number">89</span>, <span class="number">70</span>, <span class="number">91</span>, <span class="number">65</span>, <span class="number">98</span>, <span class="number">87</span>],</div><div class="line">          <span class="string">&apos;exam2&apos;</span>: [<span class="number">24</span>, <span class="number">63</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">67</span>, <span class="number">51</span>, <span class="number">79</span>, <span class="number">46</span>, <span class="number">72</span>, <span class="number">60</span>]},</div><div class="line">    index=[<span class="string">&apos;Andre&apos;</span>, <span class="string">&apos;Barry&apos;</span>, <span class="string">&apos;Chris&apos;</span>, <span class="string">&apos;Dan&apos;</span>, <span class="string">&apos;Emilio&apos;</span>,</div><div class="line">           <span class="string">&apos;Fred&apos;</span>, <span class="string">&apos;Greta&apos;</span>, <span class="string">&apos;Humbert&apos;</span>, <span class="string">&apos;Ivan&apos;</span>, <span class="string">&apos;James&apos;</span>]</div><div class="line">)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert_grades</span><span class="params">(grades)</span>:</span></div><div class="line">    <span class="string">&apos;&apos;&apos;</span></div><div class="line">    Fill in this function to convert the given DataFrame of numerical</div><div class="line">    grades to letter grades. Return a new DataFrame with the converted</div><div class="line">    grade.</div><div class="line"></div><div class="line">    The conversion rule is:</div><div class="line">        90-100 -&gt; A</div><div class="line">        80-89  -&gt; B</div><div class="line">        70-79  -&gt; C</div><div class="line">        60-69  -&gt; D</div><div class="line">        0-59   -&gt; F</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    <span class="keyword">return</span> grades.applymap(convert_grade)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">convert_grade</span><span class="params">(grade)</span>:</span></div><div class="line">    <span class="keyword">if</span> grade&gt;= <span class="number">90</span> <span class="keyword">and</span> grade &lt;=<span class="number">100</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">&apos;A&apos;</span></div><div class="line">    <span class="keyword">if</span> grade&gt;= <span class="number">80</span> <span class="keyword">and</span> grade &lt; <span class="number">100</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">&apos;B&apos;</span></div><div class="line">    <span class="keyword">if</span> grade&gt;= <span class="number">70</span> <span class="keyword">and</span> grade &lt; <span class="number">80</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">&apos;C&apos;</span></div><div class="line">    <span class="keyword">if</span> grade&gt;= <span class="number">60</span> <span class="keyword">and</span> grade &lt; <span class="number">70</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">&apos;D&apos;</span></div><div class="line">    <span class="keyword">if</span> grade &lt; <span class="number">60</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">&apos;F&apos;</span></div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">convert_grades(grades_df)</div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/6.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">convert_grades(grades_df)[<span class="string">&apos;exam1&apos;</span>].value_counts().plot.bar()</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0xed009e8&gt;
</code></pre><p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/output_13_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># DataFrame apply()</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">convert_grades_curve</span><span class="params">(exam_grades)</span>:</span></div><div class="line">        <span class="comment"># Pandas has a bult-in function that will perform this calculation</span></div><div class="line">        <span class="comment"># This will give the bottom 0% to 10% of students the grade &apos;F&apos;,</span></div><div class="line">        <span class="comment"># 10% to 20% the grade &apos;D&apos;, and so on. You can read more about</span></div><div class="line">        <span class="comment"># the qcut() function here:</span></div><div class="line">        <span class="comment"># http://pandas.pydata.org/pandas-docs/stable/generated/pandas.qcut.html</span></div><div class="line">        <span class="comment">#&#x6309;&#x7167;&#x6BD4;&#x4F8B;&#x5206;&#x914D;&#x6807;&#x7B7E;</span></div><div class="line">        <span class="keyword">return</span> pd.qcut(exam_grades,</div><div class="line">                       [<span class="number">0</span>, <span class="number">0.1</span>, <span class="number">0.2</span>, <span class="number">0.5</span>, <span class="number">0.8</span>, <span class="number">1</span>],</div><div class="line">                       labels=[<span class="string">&apos;F&apos;</span>, <span class="string">&apos;D&apos;</span>, <span class="string">&apos;C&apos;</span>, <span class="string">&apos;B&apos;</span>, <span class="string">&apos;A&apos;</span>])</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">print</span> convert_grades_curve(grades_df[<span class="string">&apos;exam1&apos;</span>])</div></pre></td></tr></table></figure>
<pre><code>Andre      F
Barry      B
Chris      C
Dan        C
Emilio     B
Fred       C
Greta      A
Humbert    D
Ivan       A
James      B
Name: exam1, dtype: category
Categories (5, object): [F &lt; D &lt; C &lt; B &lt; A]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">print</span> grades_df.apply(convert_grades_curve) <span class="comment">#apply&#x662F;&#x4E00;&#x4E2A;column&#x4E00;&#x4E2A;map,&#x4E0D;&#x662F;&#x6BCF;&#x4E00;&#x4E2A;&#x90FD;&#x904D;&#x5386;&#xFF0C;&#x6240;&#x4EE5;&#x57FA;&#x672C;&#x4E0A;&#x5B9E;&#x73B0;&#x529F;&#x80FD;&#x7684;&#x8BDD;&#x4E00;&#x6B21;&#x8981;&#x5199;&#x4E24;&#x4E2A;&#x51FD;&#x6570;</span></div></pre></td></tr></table></figure>
<pre><code>        exam1 exam2
Andre       F     F
Barry       B     B
Chris       C     C
Dan         C     C
Emilio      B     B
Fred        C     C
Greta       A     A
Humbert     D     D
Ivan        A     A
James       B     B
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">standardize_each_column</span><span class="params">(column)</span>:</span></div><div class="line">    <span class="keyword">return</span> (column - column.mean()) / column.std(ddof = <span class="number">0</span>) <span class="comment">#don&apos;t forget to set ddof = 0 !!!!! &#x610F;&#x5473;&#x7740;&#x662F;population&#x800C;&#x4E0D;&#x662F;sample</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">standardize</span><span class="params">(df)</span>:</span></div><div class="line">    <span class="keyword">return</span> df.apply(standardize_each_column)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">standardize(grades_df) <span class="comment">#&#x6240;&#x6709;&#x7684;column&#x90FD;&#x6807;&#x51C6;&#x5316;</span></div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/7.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">df = pd.DataFrame({</div><div class="line">    <span class="string">&apos;a&apos;</span>: [<span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>],</div><div class="line">    <span class="string">&apos;b&apos;</span>: [<span class="number">20</span>, <span class="number">10</span>, <span class="number">40</span>, <span class="number">50</span>, <span class="number">30</span>],</div><div class="line">    <span class="string">&apos;c&apos;</span>: [<span class="number">25</span>, <span class="number">20</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">10</span>]</div><div class="line">})</div><div class="line"><span class="comment"># DataFrame apply() - use case 2</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:   </div><div class="line">    <span class="keyword">print</span> df.apply(np.mean)</div><div class="line">    <span class="keyword">print</span> df.apply(np.max)</div><div class="line"><span class="keyword">print</span> df</div></pre></td></tr></table></figure>
<pre><code>a     5
b    50
c    25
dtype: int64
a     3.0
b    30.0
c    15.0
dtype: float64
a     5
b    50
c    25
dtype: int64
   a   b   c
0  4  20  25
1  5  10  20
2  3  40   5
3  1  50  15
4  2  30  10
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">b = df[<span class="string">&apos;a&apos;</span>].sort_values(ascending=<span class="keyword">False</span>) <span class="comment">#&#x6392;&#x5E8F;&#xFF0C;&#x4F46;&#x662F;&#x6CE8;&#x610F;index&#x4E5F;&#x53D1;&#x751F;&#x4E86;&#x53D8;&#x5316;</span></div><div class="line"><span class="keyword">print</span> b</div></pre></td></tr></table></figure>
<pre><code>1    5
0    4
2    3
4    2
3    1
Name: a, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">second_largest</span><span class="params">(df)</span>:</span></div><div class="line">    <span class="string">&apos;&apos;&apos;</span></div><div class="line">    Fill in this function to return the second-largest value of each</div><div class="line">    column of the input DataFrame.</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    <span class="keyword">return</span> df.apply(column_second_largest)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">column_second_largest</span><span class="params">(column)</span>:</span></div><div class="line">    new = column.sort_values(ascending=<span class="keyword">False</span>)</div><div class="line">    <span class="keyword">return</span> new.iloc[<span class="number">1</span>]</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">print</span> second_largest(df)</div></pre></td></tr></table></figure>
<pre><code>a     4
b    40
c    20
dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Adding a Series to a square DataFrame</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    s = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]) <span class="comment">#&#x6309;&#x7167;&#x6BCF;&#x4E2A;column&#x76F8;&#x5E94;&#x52A0;</span></div><div class="line">    df = pd.DataFrame({</div><div class="line">        <span class="number">0</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>],</div><div class="line">        <span class="number">1</span>: [<span class="number">50</span>, <span class="number">60</span>, <span class="number">70</span>, <span class="number">80</span>],</div><div class="line">        <span class="number">2</span>: [<span class="number">90</span>, <span class="number">100</span>, <span class="number">110</span>, <span class="number">120</span>],</div><div class="line">        <span class="number">3</span>: [<span class="number">130</span>, <span class="number">140</span>, <span class="number">150</span>, <span class="number">160</span>]</div><div class="line">    })</div><div class="line"></div><div class="line">    <span class="keyword">print</span> df</div><div class="line">    <span class="keyword">print</span> <span class="string">&apos;&apos;</span> <span class="comment"># Create a blank line between outputs</span></div><div class="line">    <span class="keyword">print</span> df + s</div></pre></td></tr></table></figure>
<pre><code>    0   1    2    3
0  10  50   90  130
1  20  60  100  140
2  30  70  110  150
3  40  80  120  160

    0   1    2    3
0  11  52   93  134
1  21  62  103  144
2  31  72  113  154
3  41  82  123  164
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Adding a Series to a one-row DataFrame</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    s = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</div><div class="line">    df = pd.DataFrame({<span class="number">0</span>: [<span class="number">10</span>], <span class="number">1</span>: [<span class="number">20</span>], <span class="number">2</span>: [<span class="number">30</span>], <span class="number">3</span>: [<span class="number">40</span>]})</div><div class="line"></div><div class="line">    <span class="keyword">print</span> df</div><div class="line">    <span class="keyword">print</span> s</div><div class="line">    <span class="keyword">print</span> <span class="string">&apos;&apos;</span> <span class="comment"># Create a blank line between outputs</span></div><div class="line">    <span class="keyword">print</span> df + s</div></pre></td></tr></table></figure>
<pre><code>    0   1   2   3
0  10  20  30  40
0    1
1    2
2    3
3    4
dtype: int64

    0   1   2   3
0  11  22  33  44
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Adding a Series to a one-column DataFrame</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    s = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</div><div class="line">    df = pd.DataFrame({<span class="number">0</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>]})</div><div class="line"></div><div class="line">    <span class="keyword">print</span> df</div><div class="line">    <span class="keyword">print</span> <span class="string">&apos;&apos;</span> <span class="comment"># Create a blank line between outputs</span></div><div class="line">    <span class="keyword">print</span> df + s</div></pre></td></tr></table></figure>
<pre><code>    0
0  10
1  20
2  30
3  40

    0   1   2   3
0  11 NaN NaN NaN
1  21 NaN NaN NaN
2  31 NaN NaN NaN
3  41 NaN NaN NaN
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Adding when DataFrame column names match Series index</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    s = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], index=[<span class="string">&apos;a&apos;</span>, <span class="string">&apos;b&apos;</span>, <span class="string">&apos;c&apos;</span>, <span class="string">&apos;d&apos;</span>])</div><div class="line">    df = pd.DataFrame({</div><div class="line">        <span class="string">&apos;a&apos;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>],</div><div class="line">        <span class="string">&apos;b&apos;</span>: [<span class="number">50</span>, <span class="number">60</span>, <span class="number">70</span>, <span class="number">80</span>],</div><div class="line">        <span class="string">&apos;c&apos;</span>: [<span class="number">90</span>, <span class="number">100</span>, <span class="number">110</span>, <span class="number">120</span>],</div><div class="line">        <span class="string">&apos;d&apos;</span>: [<span class="number">130</span>, <span class="number">140</span>, <span class="number">150</span>, <span class="number">160</span>]</div><div class="line">    })</div><div class="line"></div><div class="line">    <span class="keyword">print</span> df</div><div class="line">    <span class="keyword">print</span> s</div><div class="line">    <span class="keyword">print</span> <span class="string">&apos;&apos;</span> <span class="comment"># Create a blank line between outputs</span></div><div class="line">    <span class="keyword">print</span> df + s</div></pre></td></tr></table></figure>
<pre><code>    a   b    c    d
0  10  50   90  130
1  20  60  100  140
2  30  70  110  150
3  40  80  120  160
a    1
b    2
c    3
d    4
dtype: int64

    a   b    c    d
0  11  52   93  134
1  21  62  103  144
2  31  72  113  154
3  41  82  123  164
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Adding when DataFrame column names don&apos;t match Series index</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    s = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</div><div class="line">    df = pd.DataFrame({</div><div class="line">        <span class="number">0</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>],</div><div class="line">        <span class="number">1</span>: [<span class="number">50</span>, <span class="number">60</span>, <span class="number">70</span>, <span class="number">80</span>],</div><div class="line">        <span class="number">2</span>: [<span class="number">90</span>, <span class="number">100</span>, <span class="number">110</span>, <span class="number">120</span>],</div><div class="line">        <span class="number">3</span>: [<span class="number">130</span>, <span class="number">140</span>, <span class="number">150</span>, <span class="number">160</span>]</div><div class="line">    })</div><div class="line"></div><div class="line">    <span class="keyword">print</span> df</div><div class="line">    <span class="keyword">print</span> <span class="string">&apos;&apos;</span></div><div class="line">    <span class="keyword">print</span> df+s</div><div class="line">    <span class="keyword">print</span> <span class="string">&apos;&apos;</span> <span class="comment"># Create a blank line between outputs</span></div><div class="line">    <span class="keyword">print</span> df.add(s, axis=<span class="string">&apos;columns&apos;</span>)</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment"># The functions sub(), mul(), and div() work similarly to add()</span></div></pre></td></tr></table></figure>
<pre><code>    0   1    2    3
0  10  50   90  130
1  20  60  100  140
2  30  70  110  150
3  40  80  120  160

    0   1    2    3
0  11  52   93  134
1  21  62  103  144
2  31  72  113  154
3  41  82  123  164

    0   1    2    3
0  11  52   93  134
1  21  62  103  144
2  31  72  113  154
3  41  82  123  164
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">grades_df = pd.DataFrame(</div><div class="line">    data={<span class="string">&apos;exam1&apos;</span>: [<span class="number">43</span>, <span class="number">81</span>, <span class="number">78</span>, <span class="number">75</span>, <span class="number">89</span>, <span class="number">70</span>, <span class="number">91</span>, <span class="number">65</span>, <span class="number">98</span>, <span class="number">87</span>],</div><div class="line">          <span class="string">&apos;exam2&apos;</span>: [<span class="number">24</span>, <span class="number">63</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">67</span>, <span class="number">51</span>, <span class="number">79</span>, <span class="number">46</span>, <span class="number">72</span>, <span class="number">60</span>]},</div><div class="line">    index=[<span class="string">&apos;Andre&apos;</span>, <span class="string">&apos;Barry&apos;</span>, <span class="string">&apos;Chris&apos;</span>, <span class="string">&apos;Dan&apos;</span>, <span class="string">&apos;Emilio&apos;</span>,</div><div class="line">           <span class="string">&apos;Fred&apos;</span>, <span class="string">&apos;Greta&apos;</span>, <span class="string">&apos;Humbert&apos;</span>, <span class="string">&apos;Ivan&apos;</span>, <span class="string">&apos;James&apos;</span>]</div><div class="line">)</div><div class="line"></div><div class="line">grades_df.mean(axis=<span class="number">1</span>)</div></pre></td></tr></table></figure>
<pre><code>Andre      33.5
Barry      72.0
Chris      67.0
Dan        65.5
Emilio     78.0
Fred       60.5
Greta      85.0
Humbert    55.5
Ivan       85.0
James      73.5
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">grades_df.mean(axis=<span class="number">0</span>)</div></pre></td></tr></table></figure>
<pre><code>exam1    77.7
exam2    57.4
dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mean_diffs = grades_df.sub(grades_df.mean(axis=<span class="number">0</span>), axis=<span class="string">&quot;columns&quot;</span>) <span class="comment">#&#x6839;&#x636E;columns&#x505A;&#x51CF;&#x6CD5;</span></div><div class="line">mean_diffs.div(grades_df.std(axis=<span class="number">0</span>),axis=<span class="string">&quot;columns&quot;</span>)</div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/8.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mean_diffs = grades_df.sub(grades_df.mean(axis=<span class="number">1</span>), axis=<span class="string">&quot;index&quot;</span>) <span class="comment">#&#x6839;&#x636E;index&#x505A;&#x51CF;&#x6CD5;</span></div><div class="line">mean_diffs.div(grades_df.std(axis=<span class="number">1</span>),axis=<span class="string">&quot;index&quot;</span>)</div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/9.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">standardize</span><span class="params">(df)</span>:</span></div><div class="line">    <span class="string">&apos;&apos;&apos;</span></div><div class="line">    Fill in this function to standardize each column of the given</div><div class="line">    DataFrame. To standardize a variable, convert each value to the</div><div class="line">    number of standard deviations it is above or below the mean.</div><div class="line"></div><div class="line">    This time, try to use vectorized operations instead of apply().</div><div class="line">    You should get the same results as you did before.</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    <span class="keyword">return</span> (df - df.mean())/df.std(ddof=<span class="number">0</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">standardize_rows</span><span class="params">(df)</span>:</span></div><div class="line">    <span class="string">&apos;&apos;&apos;</span></div><div class="line">    Optional: Fill in this function to standardize each row of the given</div><div class="line">    DataFrame. Again, try not to use apply().</div><div class="line"></div><div class="line">    This one is more challenging than standardizing each column!</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">None</span></div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">values = np.array([<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">4</span>])</div><div class="line">example_df = pd.DataFrame({</div><div class="line">    <span class="string">&apos;value&apos;</span>: values,</div><div class="line">    <span class="string">&apos;even&apos;</span>: values % <span class="number">2</span> == <span class="number">0</span>,</div><div class="line">    <span class="string">&apos;above_three&apos;</span>: values &gt; <span class="number">3</span></div><div class="line">}, index=[<span class="string">&apos;a&apos;</span>, <span class="string">&apos;b&apos;</span>, <span class="string">&apos;c&apos;</span>, <span class="string">&apos;d&apos;</span>, <span class="string">&apos;e&apos;</span>, <span class="string">&apos;f&apos;</span>, <span class="string">&apos;g&apos;</span>])</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Examine DataFrame</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    <span class="keyword">print</span> example_df</div></pre></td></tr></table></figure>
<pre><code>  above_three   even  value
a       False  False      1
b       False  False      3
c       False   True      2
d        True   True      4
e       False  False      1
f        True   True      6
g        True   True      4
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Examine groups</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    grouped_data = example_df.groupby(<span class="string">&apos;even&apos;</span>)</div><div class="line">    <span class="comment"># The groups attribute is a dictionary mapping keys to lists of row indexes</span></div><div class="line">    <span class="keyword">print</span> grouped_data.groups</div></pre></td></tr></table></figure>
<pre><code>{False: Index([u&apos;a&apos;, u&apos;b&apos;, u&apos;e&apos;], dtype=&apos;object&apos;), True: Index([u&apos;c&apos;, u&apos;d&apos;, u&apos;f&apos;, u&apos;g&apos;], dtype=&apos;object&apos;)}
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Group by multiple columns</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    grouped_data = example_df.groupby([<span class="string">&apos;even&apos;</span>, <span class="string">&apos;above_three&apos;</span>])</div><div class="line">    <span class="keyword">print</span> grouped_data.groups</div></pre></td></tr></table></figure>
<pre><code>{(True, False): Index([u&apos;c&apos;], dtype=&apos;object&apos;), (False, False): Index([u&apos;a&apos;, u&apos;b&apos;, u&apos;e&apos;], dtype=&apos;object&apos;), (True, True): Index([u&apos;d&apos;, u&apos;f&apos;, u&apos;g&apos;], dtype=&apos;object&apos;)}
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Get sum of each group</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    grouped_data = example_df.groupby(<span class="string">&apos;even&apos;</span>)</div><div class="line">    <span class="keyword">print</span> grouped_data.sum()</div></pre></td></tr></table></figure>
<pre><code>       above_three  value
even                     
False          0.0      5
True           3.0     16
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Limit columns in result</span></div><div class="line"><span class="keyword">if</span> <span class="keyword">True</span>:</div><div class="line">    grouped_data = example_df.groupby(<span class="string">&apos;even&apos;</span>)</div><div class="line"></div><div class="line">    <span class="comment"># You can take one or more columns from the result DataFrame</span></div><div class="line">    <span class="keyword">print</span> grouped_data.sum()[<span class="string">&apos;value&apos;</span>]</div><div class="line"></div><div class="line">    <span class="keyword">print</span> <span class="string">&apos;\n&apos;</span> <span class="comment"># Blank line to separate results</span></div><div class="line"></div><div class="line">    <span class="comment"># You can also take a subset of columns from the grouped data before</span></div><div class="line">    <span class="comment"># collapsing to a DataFrame. In this case, the result is the same.</span></div><div class="line"></div><div class="line">    <span class="keyword">print</span> grouped_data[<span class="string">&apos;value&apos;</span>].sum()</div></pre></td></tr></table></figure>
<pre><code>even
False     5
True     16
Name: value, dtype: int32


even
False     5
True     16
Name: value, dtype: int32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">filename = <span class="string">&apos;nyc_subway_weather.csv&apos;</span></div><div class="line">subway_df = pd.read_csv(filename)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subway_df.head()</div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/10.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">%pylab inline</div><div class="line">grouped_data = subway_df.groupby(<span class="string">&apos;day_week&apos;</span>)</div><div class="line"><span class="keyword">print</span> grouped_data.mean()[<span class="string">&apos;ENTRIESn_hourly&apos;</span>].plot()</div></pre></td></tr></table></figure>
<pre><code>Populating the interactive namespace from numpy and matplotlib
Axes(0.125,0.125;0.775x0.775)
</code></pre><p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/output_42_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">grouped_data = subway_df.groupby(<span class="string">&apos;rain&apos;</span>)</div><div class="line"><span class="keyword">print</span> plt.hist(grouped_data.mean()[<span class="string">&apos;EXITSn_hourly&apos;</span>])</div></pre></td></tr></table></figure>
<pre><code>rain
0    1333.111451
1    1459.373918
Name: EXITSn_hourly, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">grouped_data = subway_df.groupby([<span class="string">&apos;UNIT&apos;</span>])</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">grouped_data[<span class="string">&apos;ENTRIESn&apos;</span>, <span class="string">&apos;EXITSn&apos;</span>].apply(hourly_for_group)</div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/11.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hourly_for_group</span><span class="params">(entries_and_exits)</span>:</span></div><div class="line">    <span class="keyword">return</span> entries_and_exits-entries_and_exits.shift(periods=<span class="number">1</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">subway_df = pd.DataFrame({</div><div class="line">    <span class="string">&apos;UNIT&apos;</span>: [<span class="string">&apos;R003&apos;</span>, <span class="string">&apos;R003&apos;</span>, <span class="string">&apos;R003&apos;</span>, <span class="string">&apos;R003&apos;</span>, <span class="string">&apos;R003&apos;</span>, <span class="string">&apos;R004&apos;</span>, <span class="string">&apos;R004&apos;</span>, <span class="string">&apos;R004&apos;</span>,</div><div class="line">             <span class="string">&apos;R004&apos;</span>, <span class="string">&apos;R004&apos;</span>],</div><div class="line">    <span class="string">&apos;DATEn&apos;</span>: [<span class="string">&apos;05-01-11&apos;</span>, <span class="string">&apos;05-02-11&apos;</span>, <span class="string">&apos;05-03-11&apos;</span>, <span class="string">&apos;05-04-11&apos;</span>, <span class="string">&apos;05-05-11&apos;</span>,</div><div class="line">              <span class="string">&apos;05-01-11&apos;</span>, <span class="string">&apos;05-02-11&apos;</span>, <span class="string">&apos;05-03-11&apos;</span>, <span class="string">&apos;05-04-11&apos;</span>, <span class="string">&apos;05-05-11&apos;</span>],</div><div class="line">    <span class="string">&apos;hour&apos;</span>: [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</div><div class="line">    <span class="string">&apos;ENTRIESn&apos;</span>: [ <span class="number">4388333</span>,  <span class="number">4388348</span>,  <span class="number">4389885</span>,  <span class="number">4391507</span>,  <span class="number">4393043</span>, <span class="number">14656120</span>,</div><div class="line">                 <span class="number">14656174</span>, <span class="number">14660126</span>, <span class="number">14664247</span>, <span class="number">14668301</span>],</div><div class="line">    <span class="string">&apos;EXITSn&apos;</span>: [ <span class="number">2911002</span>,  <span class="number">2911036</span>,  <span class="number">2912127</span>,  <span class="number">2913223</span>,  <span class="number">2914284</span>, <span class="number">14451774</span>,</div><div class="line">               <span class="number">14451851</span>, <span class="number">14454734</span>, <span class="number">14457780</span>, <span class="number">14460818</span>],</div><div class="line">    <span class="string">&apos;latitude&apos;</span>: [ <span class="number">40.689945</span>,  <span class="number">40.689945</span>,  <span class="number">40.689945</span>,  <span class="number">40.689945</span>,  <span class="number">40.689945</span>,</div><div class="line">                  <span class="number">40.69132</span> ,  <span class="number">40.69132</span> ,  <span class="number">40.69132</span> ,  <span class="number">40.69132</span> ,  <span class="number">40.69132</span> ],</div><div class="line">    <span class="string">&apos;longitude&apos;</span>: [<span class="number">-73.872564</span>, <span class="number">-73.872564</span>, <span class="number">-73.872564</span>, <span class="number">-73.872564</span>, <span class="number">-73.872564</span>,</div><div class="line">                  <span class="number">-73.867135</span>, <span class="number">-73.867135</span>, <span class="number">-73.867135</span>, <span class="number">-73.867135</span>, <span class="number">-73.867135</span>]</div><div class="line">})</div><div class="line"></div><div class="line">weather_df = pd.DataFrame({</div><div class="line">    <span class="string">&apos;DATEn&apos;</span>: [<span class="string">&apos;05-01-11&apos;</span>, <span class="string">&apos;05-01-11&apos;</span>, <span class="string">&apos;05-02-11&apos;</span>, <span class="string">&apos;05-02-11&apos;</span>, <span class="string">&apos;05-03-11&apos;</span>,</div><div class="line">              <span class="string">&apos;05-03-11&apos;</span>, <span class="string">&apos;05-04-11&apos;</span>, <span class="string">&apos;05-04-11&apos;</span>, <span class="string">&apos;05-05-11&apos;</span>, <span class="string">&apos;05-05-11&apos;</span>],</div><div class="line">    <span class="string">&apos;hour&apos;</span>: [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</div><div class="line">    <span class="string">&apos;latitude&apos;</span>: [ <span class="number">40.689945</span>,  <span class="number">40.69132</span> ,  <span class="number">40.689945</span>,  <span class="number">40.69132</span> ,  <span class="number">40.689945</span>,</div><div class="line">                  <span class="number">40.69132</span> ,  <span class="number">40.689945</span>,  <span class="number">40.69132</span> ,  <span class="number">40.689945</span>,  <span class="number">40.69132</span> ],</div><div class="line">    <span class="string">&apos;longitude&apos;</span>: [<span class="number">-73.872564</span>, <span class="number">-73.867135</span>, <span class="number">-73.872564</span>, <span class="number">-73.867135</span>, <span class="number">-73.872564</span>,</div><div class="line">                  <span class="number">-73.867135</span>, <span class="number">-73.872564</span>, <span class="number">-73.867135</span>, <span class="number">-73.872564</span>, <span class="number">-73.867135</span>],</div><div class="line">    <span class="string">&apos;pressurei&apos;</span>: [ <span class="number">30.24</span>,  <span class="number">30.24</span>,  <span class="number">30.32</span>,  <span class="number">30.32</span>,  <span class="number">30.14</span>,  <span class="number">30.14</span>,  <span class="number">29.98</span>,  <span class="number">29.98</span>,</div><div class="line">                   <span class="number">30.01</span>,  <span class="number">30.01</span>],</div><div class="line">    <span class="string">&apos;fog&apos;</span>: [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</div><div class="line">    <span class="string">&apos;rain&apos;</span>: [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</div><div class="line">    <span class="string">&apos;tempi&apos;</span>: [ <span class="number">52.</span> ,  <span class="number">52.</span> ,  <span class="number">48.9</span>,  <span class="number">48.9</span>,  <span class="number">54.</span> ,  <span class="number">54.</span> ,  <span class="number">57.2</span>,  <span class="number">57.2</span>,  <span class="number">48.9</span>,  <span class="number">48.9</span>],</div><div class="line">    <span class="string">&apos;wspdi&apos;</span>: [  <span class="number">8.1</span>,   <span class="number">8.1</span>,   <span class="number">6.9</span>,   <span class="number">6.9</span>,   <span class="number">3.5</span>,   <span class="number">3.5</span>,  <span class="number">15.</span> ,  <span class="number">15.</span> ,  <span class="number">15.</span> ,  <span class="number">15.</span> ]</div><div class="line">})</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">combine_dfs</span><span class="params">(subway_df, weather_df)</span>:</span></div><div class="line">    <span class="string">&apos;&apos;&apos;</span></div><div class="line">    Fill in this function to take 2 DataFrames, one with subway data and one with weather data,</div><div class="line">    and return a single dataframe with one row for each date, hour, and location. Only include</div><div class="line">    times and locations that have both subway data and weather data available.</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    <span class="keyword">return</span> pd.merge(subway_df,weather_df, on =[<span class="string">&apos;DATEn&apos;</span>,<span class="string">&apos;hour&apos;</span>,<span class="string">&apos;latitude&apos;</span>,<span class="string">&apos;longitude&apos;</span>], how = <span class="string">&apos;inner&apos;</span>)</div><div class="line"></div><div class="line">combine_dfs(subway_df, weather_df)[[<span class="string">&apos;DATEn&apos;</span>, <span class="string">&apos;UNIT&apos;</span>]]</div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/12.png" alt="png"></p>
<h1 id="Part-3-Drawing"><a href="#Part-3-Drawing" class="headerlink" title="Part 3 Drawing!"></a>Part 3 Drawing!</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#Histograms of subway ridership on both days with rain and days without rain</span></div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</div><div class="line">%pylab inline</div><div class="line"></div><div class="line">subway_df = pd.read_csv(<span class="string">&apos;nyc_subway_weather.csv&apos;</span>)</div></pre></td></tr></table></figure>
<pre><code>Populating the interactive namespace from numpy and matplotlib
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subway_df.head()</div></pre></td></tr></table></figure>
<p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/3.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subway_df.groupby(<span class="string">&apos;rain&apos;</span>)</div></pre></td></tr></table></figure>
<pre><code>&lt;pandas.core.groupby.DataFrameGroupBy object at 0x00000000094E4390&gt;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subway_df.groupby([<span class="string">&apos;hour&apos;</span>])[<span class="string">&apos;ENTRIESn_hourly&apos;</span>].mean().plot() <span class="comment">#0-20&#x5C0F;&#x65F6;&#x95F4;&#x8FDB;&#x5165;&#x65CB;&#x8F6C;&#x95E8;&#x7684;&#x5E73;&#x5747;&#x4EBA;&#x6570;</span></div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x94e4f60&gt;
</code></pre><p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/output_4_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rain_in_week = subway_df.groupby([<span class="string">&apos;day_week&apos;</span>,<span class="string">&apos;rain&apos;</span>])[<span class="string">&apos;ENTRIESn_hourly&apos;</span>].mean() <span class="comment">#&#x6BCF;&#x5468;&#x4E0B;&#x96E8;&#x5929;&#x5C0F;&#x65F6;&#x95F4;&#x8FDB;&#x5165;&#x65CB;&#x8F6C;&#x95E8;&#x7684;&#x5E73;&#x5747;&#x4EBA;&#x6570;</span></div><div class="line">rain_in_week</div></pre></td></tr></table></figure>
<pre><code>day_week  rain
0         0       1792.143970
          1       1948.177419
1         0       2171.126911
          1       2139.860974
2         0       2313.388767
          1       2280.795255
3         0       2264.874673
          1       2584.054627
4         0       2274.958944
          1       2284.644330
5         0       1388.219575
          1       1317.855422
6         0       1074.015694
          1       1036.095344
Name: ENTRIESn_hourly, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rain_group = subway_df.groupby([<span class="string">&apos;rain&apos;</span>,<span class="string">&apos;day_week&apos;</span>], as_index=<span class="keyword">False</span>)[<span class="string">&apos;ENTRIESn_hourly&apos;</span>] <span class="comment">#as_index=False&#x907F;&#x514D;&#x7B2C;&#x4E00;&#x4E2A;&#x7B2C;&#x4E00;&#x4E2A;key&#x505A;&#x53C2;&#x6570;</span></div><div class="line"><span class="keyword">print</span> rain_group.mean()</div></pre></td></tr></table></figure>
<pre><code>    rain  day_week  ENTRIESn_hourly
0      0         0      1792.143970
1      0         1      2171.126911
2      0         2      2313.388767
3      0         3      2264.874673
4      0         4      2274.958944
5      0         5      1388.219575
6      0         6      1074.015694
7      1         0      1948.177419
8      1         1      2139.860974
9      1         2      2280.795255
10     1         3      2584.054627
11     1         4      2284.644330
12     1         5      1317.855422
13     1         6      1036.095344
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">no_rain = plt.plot(rain_group.mean().iloc[<span class="number">0</span>:<span class="number">7</span>][<span class="string">&apos;day_week&apos;</span>],</div><div class="line">                   rain_group.mean().iloc[<span class="number">0</span>:<span class="number">7</span>][<span class="string">&apos;ENTRIESn_hourly&apos;</span>],</div><div class="line">                   label=<span class="string">&apos;Days Without Rain&apos;</span>)</div><div class="line"><span class="comment"># Days with rain</span></div><div class="line">rain = plt.plot(rain_group.mean().iloc[<span class="number">7</span>:][<span class="string">&apos;day_week&apos;</span>],</div><div class="line">                rain_group.mean().iloc[<span class="number">7</span>:][<span class="string">&apos;ENTRIESn_hourly&apos;</span>],c=<span class="string">&quot;r&quot;</span>,</div><div class="line">                label=<span class="string">&apos;Days With Rain&apos;</span>)</div><div class="line"></div><div class="line">plt.legend() <span class="comment">#&#x52A0;&#x6807;&#x7B7E;</span></div><div class="line">plt.xlabel(<span class="string">&apos;Day of Week (Monday=0)&apos;</span>)</div><div class="line">plt.ylabel(<span class="string">&apos;Mean Entries Per Hour&apos;</span>)</div><div class="line">plt.title(<span class="string">&apos;Ridership: Rain vs No Rain&apos;</span>)</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.text.Text at 0x9ad4f98&gt;
</code></pre><p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/output_7_1.png" alt="png"></p>
<p>A scatterplot of subway stations with latitude and longitude as the x and y axes and ridership as the bubble size</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># A scatterplot of subway stations with latitude and longitude as the x and y axes and ridership as the bubble size</span></div><div class="line">lat_lon_group = subway_df.groupby([<span class="string">&apos;latitude&apos;</span>, <span class="string">&apos;longitude&apos;</span>], as_index=<span class="keyword">False</span>)</div><div class="line">mean_entries = lat_lon_group[<span class="string">&apos;ENTRIESn&apos;</span>].mean()</div><div class="line">N = len(mean_entries)</div><div class="line">colors = np.random.rand(N,<span class="number">3</span>)</div><div class="line"><span class="keyword">print</span> mean_entries[[<span class="string">&apos;latitude&apos;</span>,<span class="string">&apos;longitude&apos;</span>]]</div><div class="line"></div><div class="line">plt.scatter(mean_entries[<span class="string">&apos;latitude&apos;</span>], mean_entries[<span class="string">&apos;longitude&apos;</span>], c=colors, s=mean_entries[<span class="string">&apos;ENTRIESn&apos;</span>]/<span class="number">500000</span>, alpha=<span class="number">0.5</span>)</div><div class="line">plt.xlabel(<span class="string">&apos;Latitude&apos;</span>)</div><div class="line">plt.ylabel(<span class="string">&apos;Longitude&apos;</span>)</div><div class="line">plt.title(<span class="string">&apos;Ridership by Latitude and Longitude&apos;</span>)</div></pre></td></tr></table></figure>
<pre><code>      latitude  longitude
0    40.576152 -73.975925
1    40.576298 -73.968523
2    40.577961 -73.961806
3    40.589547 -73.974295
4    40.590867 -73.797011
5    40.592334 -73.788493
6    40.593214 -73.776433
7    40.595234 -73.955090
8    40.595381 -73.768194
9    40.600138 -73.761520
10   40.603983 -73.755383
11   40.604798 -73.998456
12   40.607958 -74.001782
13   40.608691 -73.957772
14   40.609147 -73.972986
15   40.613513 -74.000645
16   40.616624 -74.030964
17   40.617568 -73.959360
18   40.619588 -73.998842
19   40.622715 -74.028368
20   40.625028 -73.960819
21   40.629164 -73.961678
22   40.629702 -74.025514
23   40.629881 -73.977149
24   40.631412 -73.995473
25   40.634945 -74.023411
26   40.636232 -73.994765
27   40.640905 -73.963866
28   40.641426 -74.017972
29   40.643738 -74.073622
..         ...        ...
204  40.829495 -73.874559
205  40.833773 -73.918430
206  40.834255 -73.851222
207  40.835535 -73.921380
208  40.839892 -73.842952
209  40.840048 -73.917775
210  40.840778 -73.940091
211  40.844406 -73.914621
212  40.845892 -73.910136
213  40.847369 -73.939683
214  40.848635 -73.912497
215  40.849495 -73.933632
216  40.852417 -73.828082
217  40.852465 -73.828125
218  40.853390 -73.907733
219  40.855176 -73.929384
220  40.856085 -73.900695
221  40.858389 -73.903828
222  40.859022 -73.934190
223  40.860523 -73.925575
224  40.862803 -73.901034
225  40.862941 -73.901199
226  40.864653 -73.918719
227  40.869359 -73.915329
228  40.873399 -73.890084
229  40.874551 -73.909879
230  40.877796 -73.866341
231  40.878867 -73.904858
232  40.885973 -73.878851
233  40.889185 -73.898549

[234 rows x 2 columns]





&lt;matplotlib.text.Text at 0xeb16a90&gt;
</code></pre><p><img src="/2017/01/15/Numpy-and-pandas-for-2D-data/output_9_2.png" alt="png"></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/numpy/" rel="tag"># numpy</a>
          
            <a href="/tags/pandas/" rel="tag"># pandas</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/01/15/Numpy-and-pandas-for-1D-data/" rel="next" title="Numpy and pandas for data">
                <i class="fa fa-chevron-left"></i> Numpy and pandas for data
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="ClarkYu" />
          <p class="site-author-name" itemprop="name">ClarkYu</p>
          <p class="site-description motion-element" itemprop="description">Keep thinking and writing!</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/clarkyu2016" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/chijingclark" target="_blank" title="Facebook">
                  
                    <i class="fa fa-fw fa-facebook"></i>
                  
                  Facebook
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Part-1"><span class="nav-number">1.</span> <span class="nav-text">Part 1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Part-2"><span class="nav-number">2.</span> <span class="nav-text">Part 2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Part-3-Drawing"><span class="nav-number">3.</span> <span class="nav-text">Part 3 Drawing!</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-paper-plane"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ClarkYu</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'clarkyu';
      var disqus_identifier = '2017/01/15/Numpy-and-pandas-for-2D-data/';

      var disqus_title = "Numpy and pandas for 2D data";


      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      
        var disqus_config = function () {
            this.page.url = disqus_url;
            this.page.identifier = disqus_identifier;
            this.page.title = disqus_title;
        };
        run_disqus_script('embed.js');
      

    </script>
  









  
  

  

  

  

  


</body>
</html>
